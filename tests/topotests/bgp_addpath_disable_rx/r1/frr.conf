debug bgp updates
debug bgp bestpath 10.0.0.0/24
!
int r1-eth0
 ip address 192.168.137.1/24
!
router bgp 65000
 bgp router-id 192.168.137.1
 no bgp default ipv4-unicast
 bgp deterministic-med
 bgp long-lived-graceful-restart stale-time 1
 bgp graceful-restart stalepath-time 1
 bgp graceful-restart restart-time 1
 bgp graceful-restart-disable
 no bgp enforce-first
! no bgp suppress-duplicates
 neighbor AS65100-V4 peer-group
 neighbor AS65100-V4 remote-as 65100
 neighbor AS65100-V4 description Varteh
 neighbor AS65100-V4 passive
 neighbor AS65100-V4 enforce-first-as
 neighbor AS65100-V4 timers 5 15
 neighbor AS65100-V4 timers delayopen 30
 neighbor AS65100-V4 graceful-restart-disable
 neighbor AS65200-V4 peer-group
 neighbor AS65200-V4 remote-as 65200
 neighbor AS65200-V4 description AS65200
 neighbor AS65200-V4 passive
 neighbor AS65200-V4 enforce-first-as
 neighbor AS65200-V4 timers 5 15
 neighbor AS65200-V4 timers delayopen 30
 neighbor AS65200-V4 graceful-restart-disable
 neighbor AS65600-V4 peer-group
 neighbor AS65600-V4 remote-as 65600
 neighbor AS65600-V4 description AS65600
 neighbor AS65600-V4 passive
 neighbor AS65600-V4 enforce-first-as
 neighbor AS65600-V4 timers 5 15
 neighbor AS65600-V4 timers delayopen 30
 neighbor AS65600-V4 graceful-restart-disable
 neighbor 192.168.137.100 peer-group AS65100-V4
 neighbor 192.168.137.100 description AS65100-1
 neighbor 192.168.137.201 peer-group AS65200-V4
 neighbor 192.168.137.201 description AS65200-1
 neighbor 192.168.137.202 peer-group AS65200-V4
 neighbor 192.168.137.202 description AS65200-2
 neighbor 192.168.137.60 peer-group AS65600-V4
 neighbor 192.168.137.60 description AS65600-1
 !
 address-family ipv4 unicast
  neighbor AS65100-V4 activate
  neighbor AS65100-V4 addpath-tx-bestpath-per-AS
  neighbor AS65100-V4 soft-reconfiguration inbound
  neighbor AS65100-V4 route-server-client
  neighbor AS65100-V4 prefix-list v4_ban in
  neighbor AS65100-V4 prefix-list v4_ban out
  neighbor AS65100-V4 route-map AS65100-IN in
  neighbor AS65100-V4 route-map AS65100-OUT out
  neighbor AS65100-V4 attribute-unchanged next-hop
  neighbor AS65200-V4 activate
  neighbor AS65200-V4 addpath-tx-bestpath-per-AS
  neighbor AS65200-V4 disable-addpath-rx
  neighbor AS65200-V4 soft-reconfiguration inbound
  neighbor AS65200-V4 route-server-client
  neighbor AS65200-V4 prefix-list v4_ban in
  neighbor AS65200-V4 prefix-list v4_ban out
  neighbor AS65200-V4 route-map AS65200-IN in
  neighbor AS65200-V4 route-map AS65200-OUT out
  neighbor AS65200-V4 attribute-unchanged next-hop
  neighbor AS65600-V4 activate
  neighbor AS65600-V4 addpath-tx-bestpath-per-AS
  neighbor AS65600-V4 disable-addpath-rx
  neighbor AS65600-V4 soft-reconfiguration inbound
  neighbor AS65600-V4 route-server-client
  neighbor AS65600-V4 prefix-list v4_ban in
  neighbor AS65600-V4 prefix-list v4_ban out
  neighbor AS65600-V4 route-map AS65600-IN in
  neighbor AS65600-V4 route-map AS65600-OUT out
  neighbor AS65600-V4 attribute-unchanged next-hop
  neighbor 192.168.137.201 disable-addpath-rx
  neighbor 192.168.137.202 disable-addpath-rx
  neighbor 192.168.137.60 disable-addpath-rx
 exit-address-family
!
exit
!
access-list telnet-filter seq 5 permit 127.0.0.1/32
access-list telnet-filter seq 10 deny any
ip prefix-list v4_ban seq 10 deny 0.0.0.0/8 le 32
ip prefix-list v4_ban seq 15 deny 192.168.0.0/16 le 32
ip prefix-list v4_ban seq 20 deny 127.0.0.0/8 le 32
ip prefix-list v4_ban seq 25 deny 100.64.0.0/10 le 32
ip prefix-list v4_ban seq 30 deny 169.254.0.0/16 le 32
ip prefix-list v4_ban seq 35 deny 172.16.0.0/12 le 32
ip prefix-list v4_ban seq 40 deny 192.0.2.0/24 le 32
ip prefix-list v4_ban seq 45 deny 192.88.99.0/24 le 32
ip prefix-list v4_ban seq 55 deny 192.0.0.0/24 le 32
ip prefix-list v4_ban seq 60 deny 198.18.0.0/15 le 32
ip prefix-list v4_ban seq 65 deny 198.51.100.0/24 le 32
ip prefix-list v4_ban seq 70 deny 203.0.113.0/24 le 32
ip prefix-list v4_ban seq 75 deny 224.0.0.0/3 le 32
ip prefix-list v4_ban seq 80 deny 0.0.0.0/0
ip prefix-list v4_ban seq 100 permit 0.0.0.0/0 le 24
!
bgp community-list expanded DEL_C seq 5 deny ^(1:.*)_(.*)_+$
bgp community-list expanded DEL_C seq 10 deny ^(0:.*)_(.*)_+$
bgp community-list expanded DEL_C seq 15 permit .*:.*
bgp community-list standard c_AS65100 seq 1 deny 65000:65100
bgp community-list standard c_AS65100 seq 5 permit 1:65100
bgp community-list standard c_AS65100 seq 10 deny 0:65100
bgp community-list standard c_AS65100 seq 15 permit 1:65000
bgp community-list standard c_AS65100 seq 20 deny 0:65000
bgp community-list standard c_AS65200 seq 1 deny 65000:65200
bgp community-list standard c_AS65200 seq 5 permit 1:65200
bgp community-list standard c_AS65200 seq 10 deny 0:65200
bgp community-list standard c_AS65200 seq 15 permit 1:65000
bgp community-list standard c_AS65200 seq 20 deny 0:65000
bgp community-list standard c_AS65600 seq 1 deny 65000:65060
bgp community-list standard c_AS65600 seq 5 permit 1:65060
bgp community-list standard c_AS65600 seq 10 deny 0:65060
bgp community-list standard c_AS65600 seq 15 permit 1:65000
bgp community-list standard c_AS65600 seq 20 deny 0:65000
!
!
route-map AS65200-IN permit 10
 call _DEFAULT-IN
 set comm-list DEL_C delete
 set community 65000:65200 additive
 set ipv6 next-hop peer-address
 set ipv6 next-hop prefer-global
 set ip next-hop peer-address
exit
!
route-map AS65200-OUT permit 10
 match community c_AS65200
exit
!
route-map AS65200-OUT deny 20
exit
!
route-map AS65100-IN permit 10
 call _DEFAULT-IN
 set comm-list DEL_C delete
 set community 65000:65100 additive
 set ipv6 next-hop peer-address
 set ipv6 next-hop prefer-global
 set ip next-hop peer-address
exit
!
route-map AS65100-OUT permit 10
 match community c_AS65100
exit
!
route-map AS65100-OUT deny 20
exit
!
route-map AS65600-IN permit 10
 call _DEFAULT-IN
 set comm-list DEL_C delete
 set community 65000:65060 additive
 set ipv6 next-hop peer-address
 set ipv6 next-hop prefer-global
 set ip next-hop peer-address
exit
!
route-map AS65600-OUT permit 10
 match community c_AS65600
exit
!
route-map AS65600-OUT deny 20
exit
!
route-map _DEFAULT-IN permit 10
 on-match goto 100
 match rpki valid
 set local-preference 100
 set table 55
exit
!
route-map _DEFAULT-IN permit 20
 on-match goto 100
 match rpki invalid
 set table 666
 set local-preference 5
exit
!
route-map _DEFAULT-IN permit 30
 on-match goto 100
 set local-preference 10
 set table 667
exit
!
route-map _DEFAULT-IN permit 100
 match community c_DENY
exit
!
route-map _DEFAULT-IN permit 110
 match community c_PERMIT
exit
!
route-map _DEFAULT-IN permit 120
 set community 1:65000 additive
exit
!
